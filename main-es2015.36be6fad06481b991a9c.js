(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{0:function(t,e,n){t.exports=n("2v48")},"2v48":function(t,e,n){"use strict";n.r(e);var r=n("fXoL"),o=n("3Pt+"),i=n("jhN1"),a=n("R1ws"),s=n("NZHw");let c=(()=>{class t{constructor(t,e){this.accessor=t,this.injector=e}static forRoot(e=[]){return{ngModule:t,providers:[s.b,s.c,s.d,...e]}}}return t.\u0275mod=r.Nb({type:t}),t.\u0275inj=r.Mb({factory:function(e){return new(e||t)(r.Zb(s.b,2),r.Zb(s.c,2))}}),t})();var u=n("Tfvs"),l=n("ty+z"),d=n("/wON"),p=n("AcyG"),f=n("tyNb");let b=(()=>{class t{}return t.\u0275mod=r.Nb({type:t}),t.\u0275inj=r.Mb({factory:function(e){return new(e||t)},imports:[[f.b.forRoot([{path:"",redirectTo:"count",pathMatch:"full"},{path:"count",loadChildren:()=>Promise.all([n.e(0),n.e(11)]).then(n.bind(null,"iBbY")).then(t=>t.CountModule)},{path:"todo",loadChildren:()=>Promise.all([n.e(0),n.e(2),n.e(13)]).then(n.bind(null,"BX/J")).then(t=>t.TodoModule)},{path:"person",loadChildren:()=>Promise.all([n.e(0),n.e(3),n.e(12)]).then(n.bind(null,"rAEy")).then(t=>t.PersonModule)},{path:"amount",loadChildren:()=>Promise.all([n.e(0),n.e(9)]).then(n.bind(null,"h86J")).then(t=>t.AmountModule)},{path:"article",loadChildren:()=>Promise.all([n.e(0),n.e(2),n.e(3),n.e(10)]).then(n.bind(null,"BVaH")).then(t=>t.ArticleModule)}],{useHash:!0})],f.b]}),t})();var g=n("ofXK");const v=function(){return["count"]},h=function(){return["todo"]},y=function(){return["person"]},S=function(){return["amount"]},m=function(){return["article"]};let E=(()=>{class t{constructor(t){this.store=t,this.snapshot=this.store.select(t=>t)}ngOnInit(){console.log("[isDevMode]",Object(r.Y)())}}return t.\u0275fac=function(e){return new(e||t)(r.Pb(p.g))},t.\u0275cmp=r.Jb({type:t,selectors:[["app-root"]],decls:72,vars:15,consts:[[1,"panel"],["src","https://habrastorage.org/webt/k7/ih/pc/k7ihpcg6w-jz-rzksmiyuip5_so.png",1,"logo"],[1,"panel-content"],[1,"menu"],[1,"menu-top"],["href","https://github.com/ngxs-labs/data/tree/master/docs","target","_blank",1,"link"],["href","https://stackblitz.io/github/ngxs-labs/data","target","_blank",1,"link"],[1,"ng-icon"],["src","https://cdn.worldvectorlogo.com/logos/angular-icon-1.svg",1,"img"],[1,"link",3,"routerLink"],[1,"container"],[1,"content"]],template:function(t,e){1&t&&(r.Vb(0,"div",0),r.vc(1,"\n    "),r.Qb(2,"img",1),r.vc(3,"\n\n    "),r.Vb(4,"div",2),r.vc(5,"\n        "),r.Vb(6,"h2"),r.vc(7,"Store:"),r.Ub(),r.vc(8,"\n        "),r.Vb(9,"pre"),r.vc(10),r.gc(11,"json"),r.gc(12,"async"),r.Ub(),r.vc(13,"\n    "),r.Ub(),r.vc(14,"\n"),r.Ub(),r.vc(15,"\n\n"),r.Vb(16,"div",3),r.vc(17,"\n    "),r.Vb(18,"div",4),r.vc(19,"\n        "),r.Vb(20,"span"),r.vc(21,"\n            \u{1f9fe}\n            "),r.Vb(22,"a",5),r.vc(23,"\n                Official documentation\n            "),r.Ub(),r.vc(24,"\n        "),r.Ub(),r.vc(25,"\n        "),r.Vb(26,"span"),r.vc(27,"\n            \u{1f680} "),r.Vb(28,"a",6),r.vc(29,"Stackblitz"),r.Ub(),r.vc(30,"\n        "),r.Ub(),r.vc(31,"\n        "),r.Vb(32,"span",7),r.vc(33,"\n            "),r.Qb(34,"img",8),r.vc(35,"\n            Angular 8+, NGXS 3.6.2+\n        "),r.Ub(),r.vc(36,"\n    "),r.Ub(),r.vc(37,"\n\n    "),r.Vb(38,"span"),r.vc(39,"\u{1f3c0} "),r.Vb(40,"a",9),r.vc(41,"CountState"),r.Ub(),r.Ub(),r.vc(42,"\n    "),r.Vb(43,"span"),r.vc(44,"\u{1f9ed} "),r.Vb(45,"a",9),r.vc(46,"TodoState"),r.Ub(),r.Ub(),r.vc(47,"\n    "),r.Vb(48,"span"),r.vc(49,"\u{1f60b} "),r.Vb(50,"a",9),r.vc(51,"PersonState"),r.Ub(),r.Ub(),r.vc(52,"\n    "),r.Vb(53,"span"),r.vc(54,"\u{1f4b0} "),r.Vb(55,"a",9),r.vc(56,"AmountState"),r.Ub(),r.Ub(),r.vc(57,"\n    "),r.Vb(58,"span"),r.vc(59,"\u{1f4cb} "),r.Vb(60,"a",9),r.vc(61,"ArticleEntitiesState"),r.Ub(),r.Ub(),r.vc(62,"\n"),r.Ub(),r.vc(63,"\n\n"),r.Qb(64,"br"),r.vc(65,"\n\n"),r.Vb(66,"div",10),r.vc(67,"\n    "),r.Vb(68,"div",11),r.Qb(69,"router-outlet"),r.Ub(),r.vc(70,"\n"),r.Ub(),r.vc(71,"\n")),2&t&&(r.Eb(10),r.wc(r.hc(11,6,r.hc(12,8,e.snapshot))),r.Eb(30),r.kc("routerLink",r.lc(10,v)),r.Eb(5),r.kc("routerLink",r.lc(11,h)),r.Eb(5),r.kc("routerLink",r.lc(12,y)),r.Eb(5),r.kc("routerLink",r.lc(13,S)),r.Eb(5),r.kc("routerLink",r.lc(14,m)))},directives:[f.a,f.c],pipes:[g.f,g.b],encapsulation:2,changeDetection:0}),t})(),O=(()=>{class t{}return t.\u0275mod=r.Nb({type:t,bootstrap:[E]}),t.\u0275inj=r.Mb({factory:function(e){return new(e||t)},providers:[],imports:[[i.a,o.e,b,a.b,o.k,p.c.forRoot([],{developmentMode:!1,executionStrategy:p.d}),d.a.forRoot(),c.forRoot([u.b,u.a]),l.a]]}),t})();Object(r.U)(),i.d().bootstrapModule(O).catch(t=>console.error(t))},"BS/u":function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="BS/u"},NZHw:function(t,e,n){"use strict";function r(t){return"undefined"!==t&&null!=t}function o(t){return!r(t)}function i(t){return JSON.parse(JSON.stringify(void 0===t?{}:t))}function a(t){return"object"==typeof t&&!Array.isArray(t)&&null!==t}function s(t){return t.NGXS_OPTIONS_META||{name:""}}n.d(e,"u",(function(){return r})),n.d(e,"v",(function(){return o})),n.d(e,"l",(function(){return i})),n.d(e,"w",(function(){return a})),n.d(e,"f",(function(){return l})),n.d(e,"e",(function(){return d})),n.d(e,"a",(function(){return p})),n.d(e,"q",(function(){return f})),n.d(e,"s",(function(){return b})),n.d(e,"c",(function(){return E})),n.d(e,"b",(function(){return O})),n.d(e,"d",(function(){return m})),n.d(e,"i",(function(){return N})),n.d(e,"j",(function(){return A})),n.d(e,"k",(function(){return I})),n.d(e,"y",(function(){return w})),n.d(e,"g",(function(){return x})),n.d(e,"h",(function(){return M})),n.d(e,"o",(function(){return P})),n.d(e,"z",(function(){return G})),n.d(e,"n",(function(){return R})),n.d(e,"r",(function(){return C})),n.d(e,"m",(function(){return U})),n.d(e,"p",(function(){return V})),n.d(e,"t",(function(){return $})),n.d(e,"x",(function(){return B}));var c=n("UFJs");class u extends Error{constructor(t){super(`${c.c.NGXS_DATA_CHILDREN_CONVERT}. Cannot convert ${t&&t.constructor?t.constructor.name:t} to PlainObject`)}}function l(t){const e=s(t),n=e.children||[],r=i(e.defaults);if(n.length){if(a(r))return function(t,e){return e.reduce((t,e)=>{const n=s(e);if(!n.name)throw new Error(c.c.NGXS_DATA_STATE_NAME_NOT_FOUND);return t[n.name.toString()]=l(e),t},t)}(r,n);throw new u(r)}return r}function d(t){const{statePath:e,argumentsNames:n,methodName:r,argumentRegistry:o}=t;let i="";for(let a=0;a<n.length;a++)(null==o?void 0:o.getArgumentNameByIndex(a))?i+=null==o?void 0:o.getArgumentNameByIndex(a):(null==o?void 0:o.getPayloadTypeByIndex(a))?i+=null==o?void 0:o.getPayloadTypeByIndex(a):i+="$arg"+a,a!==n.length-1&&(i+=", ");return`@${e.replace(/\./g,"/")}.${r}(${i})`}function p(t){return(t+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1)[0].replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean)}function f(t){if(!t.hasOwnProperty(c.f)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(t,c.f,{value:e})}return function(t){return t[c.f]}(t)}function b(t){return t[c.d]}const g=t=>{const e=t instanceof Date;if("object"!=typeof t||null===t||e)return t;Object.freeze(t);const n="function"==typeof t,r=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(t).forEach(e=>{!r.call(t,e)||n&&("caller"===e||"callee"===e||"arguments"===e)||null===t[e]||"object"!=typeof t[e]&&"function"!=typeof t[e]||Object.isFrozen(t[e])||g(t[e])}),t};var v=n("fXoL"),h=n("AcyG"),y=n("z5Zb"),S=n("2Vo4");let m=(()=>{class t{constructor(t){this.sequence$=new S.a(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return t.\u0275fac=function(e){return new(e||t)(v.Zb(h.g,8))},t.\u0275prov=v.Lb({token:t,factory:t.\u0275fac}),t})(),E=(()=>{class t{constructor(e,n,r){t.store=e.get(h.g),t.ngZone=e.get(v.B),t.factory=n,t.context=r,t.computed=e.get(m)}}return t.store=null,t.computed=null,t.context=null,t.factory=null,t.ngZone=null,t.\u0275fac=function(e){return new(e||t)(v.Zb(v.t),v.Zb(y.d),v.Zb(y.c))},t.\u0275prov=v.Lb({token:t,factory:t.\u0275fac}),t})(),O=(()=>{class t{constructor(){t.statesCachedMeta.clear()}static createStateContext(t){return E.context.createStateContext(t)}static ensureMappedState(e){if(!E.factory||!e)throw new Error(c.c.NGXS_DATA_MODULE_EXCEPTION);return(e.name?t.statesCachedMeta.get(e.name):null)||t.ensureMeta(e)}static getRepositoryByInstance(e){const n=b(t.getStateClassByInstance(e))||null;if(!n)throw new Error(c.c.NGXS_DATA_STATE_DECORATOR);return n}static getStateClassByInstance(t){return(t||{}).constructor}static clearMetaByInstance(e){const n=t.getRepositoryByInstance(e);n.stateMeta.actions={},n.operations={}}static createPayload(t,e){const n={},r=Array.from(t);for(let o=0;o<r.length;o++)(null==e?void 0:e.getPayloadTypeByIndex(o))&&(n[null==e?void 0:e.getPayloadTypeByIndex(o)]=r[o]);return Object.keys(n).length>0?n:null}static createAction(e,n,r){const o=t.createPayload(n,r);var i;return new(i=e.type,class{constructor(t){t&&Object.keys(t).forEach(e=>{this[e]=t[e]})}static get type(){return i}})(o)}static ensureMeta(e){var n;const r=e.name?null===(n=E.factory.states)||void 0===n?void 0:n.find(t=>t.name===e.name):null;return r&&e.name&&t.statesCachedMeta.set(e.name,r),r}}return t.statesCachedMeta=new Map,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=v.Lb({token:t,factory:t.\u0275fac}),t})();function N(t){return{enumerable:!0,configurable:!0,get(){const e=b(t),n=O.ensureMappedState(e.stateMeta);return O.createStateContext(n)}}}function A(t,e){(function(t){var e;const n=null!==(e=b(t))&&void 0!==e?e:null;return(!n||(null==n?void 0:n.stateClass)!==t)&&function(t){Object.defineProperty(t,c.d,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:t}})}(t),b(t)}(t)).stateMeta=e}var _=n("lJxs"),T=n("UXun");function I(t){const e=b(t),n=e.stateMeta&&e.stateMeta.name||null;if(n){const e=`__${n}__selector`;Object.defineProperties(t.prototype,{[e]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(this[e])return this[e];if(!E.store)throw new Error(c.c.NGXS_DATA_MODULE_EXCEPTION);return this[e]=E.store.select(t).pipe(Object(_.a)(t=>Object(v.Y)()?g(t):t),Object(T.a)({refCount:!0,bufferSize:1})),this[e]}}})}}function w(t,e){if(t.hasOwnProperty("prototype"))throw new Error(c.c.NGXS_DATA_STATIC_ACTION);if(void 0===e)throw new Error(c.c.NGXS_DATA_ACTION)}function x(){if(!E.ngZone)throw new Error(c.c.NGXS_DATA_MODULE_EXCEPTION)}var D=n("cp0P");function M(t,e){return Object(D.a)([t,e]).pipe(Object(_.a)(t=>t.pop()))}class j extends Error{constructor(t,e){super(`An argument with the name '${t}' already exists in the method '${e}'`)}}class k{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(t){var e;return null!==(e=this.payloadMap.get(t))&&void 0!==e?e:null}getArgumentNameByIndex(t){var e;return null!==(e=this.argumentMap.get(t))&&void 0!==e?e:null}createPayloadType(t,e,n){this.checkDuplicateName(t,e),this.payloadMap.set(n,t),this.payloadMap.set(t,t)}createArgumentName(t,e,n){this.checkDuplicateName(t,e),this.argumentMap.set(n,t),this.argumentMap.set(t,t)}checkDuplicateName(t,e){if(this.argumentMap.has(t)||this.payloadMap.has(t))throw new j(t,e)}}function C(t){return t[c.a]}function P(t,e){const n=t[e];return C(n)||Object.defineProperties(n,{[c.a]:{enumerable:!0,configurable:!0,value:new k}}),C(n)}function G(t,e){var n;if(!(null===(n=Object.getOwnPropertyDescriptor(t,e))||void 0===n?void 0:n.get))throw new Error(c.c.NGXS_COMPUTED_DECORATOR+`\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}function R(t){if(!t)throw new Error(c.c.NGXS_DATA_STATE_DECORATOR);return Object.assign(Object.assign({},t),{getState:()=>Object(v.Y)()?g(t.getState()):t.getState(),setState(e){t.setState(e)},patchState(e){t.patchState(e)}})}function X(){return`__${c.b}__`}function L(t){var e;return null!==(e=t[X()])&&void 0!==e?e:null}function U(t){return L(t)||Object.defineProperties(t,{[X()]:{enumerable:!0,configurable:!0,value:new WeakMap}}),L(t)}function V(t){return Object(v.Y)()?g(t):t}function $(){var t,e;return null!==(e=null===(t=null==E?void 0:E.computed)||void 0===t?void 0:t.sequenceValue)&&void 0!==e?e:0}var z=n("7+OI");function B(t){let e=!1;return Object(z.a)(t)&&(e=!0),e}},Tfvs:function(t,e,n){"use strict";n.d(e,"d",(function(){return k})),n.d(e,"c",(function(){return C})),n.d(e,"b",(function(){return M})),n.d(e,"a",(function(){return a}));var r=n("fXoL");const o=new r.s("NGXS_DATA_STORAGE_CONTAINER_TOKEN");class i{constructor(){this.providers=new Set,this.keys=new Map}getProvidedKeys(){return Array.from(this.keys.keys())}}const a={provide:o,useFactory:function(){return new i}},s=new r.s("NGXS_DATA_STORAGE_DECODE_TYPE_TOKEN");var c=n("AcyG"),u=n("ofXK"),l=n("NZHw"),d=n("UFJs"),p=(n("i2FL"),n("xgIS")),f=n("vkgz");function b(t){return-1!==t.ttl&&!isNaN(t.ttl)&&t.ttl>0}function g(t){return Date.now()>=t.getTime()}var v=n("l5mm");function h(t){return`${t.prefixKey}${t.path}`}function y(t,e){var n,r,o;const{provider:i,expiry:a}=e,s={key:t,expiry:a.toISOString(),timestamp:new Date(Date.now()).toISOString()},c=i.stateInstance;null===(n=null==c?void 0:c.expired$)||void 0===n||n.next(s),(null==c?void 0:c.ngxsDataAfterExpired)&&(l.c.ngZone?null===(r=l.c.ngZone)||void 0===r||r.run(()=>{var t;return null===(t=null==c?void 0:c.ngxsDataAfterExpired)||void 0===t?void 0:t.call(c,s,i)}):null===(o=null==c?void 0:c.ngxsDataAfterExpired)||void 0===o||o.call(c,s,i))}class S extends Error{constructor(t){super(`${t}. \nIncorrect structure for deserialization!!! Your structure should be like this: \n${JSON.stringify({lastChanged:"2020-01-01T12:00:00.000Z",data:"{}",version:1},null,4)}`)}}function m(t){try{return JSON.parse(t)}catch(e){throw new S(e.message)}}function E(t){var e,n;const{provider:r,map:o}=t;null===(e=o.get(r))||void 0===e||e.subscription.unsubscribe();const i=()=>{const e=new Date(Date.now()).toISOString(),n=Object(v.a)(r.ttlDelay).subscribe(()=>function(t,e,n){const{provider:r,expiry:o,map:i,engine:a}=e,s=h(r),c=a.getItem(s);if(c){if(g(o)){const o=new Date(Date.now()).toISOString();!function(t,e,n){const{provider:r,engine:o}=n;switch(r.ttlExpiredStrategy){case 0:o.removeItem(t);break;case 1:const n=m(e);n.data=null,o.setItem(t,JSON.stringify(n))}}(s,c,e),y(s,e),n.unsubscribe(),i.set(r,{subscription:n,startListen:t,endListen:o})}}else n.unsubscribe()}(e,t,n));o.set(r,{subscription:n,startListen:e,endListen:null})};l.c.ngZone?null===(n=l.c.ngZone)||void 0===n||n.runOutsideAngular(()=>i()):i()}class O extends Error{constructor(){super("missing key 'data' or it's value not serializable.")}}class N extends Error{constructor(t){super(`lastChanged key not found in object ${t}.`)}}class A extends Error{constructor(t){super(`It's not possible to determine version (${t}), since it must be a integer type and must equal or more than 1.`)}}function _(t,e){const n=Object(l.u)(t)?t:null;return"base64"===e.decode?btoa(JSON.stringify(n)):n}class T extends Error{constructor(t){super(`${d.c.NGXS_PERSISTENCE_ENGINE} \nMetadata { key: '${t}' }`)}}class I extends Error{constructor(){super("StorageEngine instance should be implemented by DataStorageEngine interface")}}function w(t,e){const n=t.existingEngine||e.get(t.useClass,null);if(!n)throw new T(h(t));if(!("getItem"in n))throw new I;return n}function x(t,e){console.warn(`${d.c.NGXS_PERSISTENCE_SERIALIZE} from metadata { key: '${t}' }. \nError serialize: ${e}`)}let D=(()=>{class t{constructor(e,n){this._platformId=e,t.injector=n,this.listenWindowEvents()}get store(){return t.injector.get(c.g,null)}get size(){return this.providers.size}get ttlListeners(){return t.ttlListeners}get container(){return t.injector.get(o)}get providers(){return this.container.providers}get keys(){return this.container.keys}get entries(){return this.providers.entries()}get skipStorageInterceptions(){return 0===this.size||Object(u.r)(this._platformId)}static checkIsStorageEvent(t,e,n){var r;const{action:o,provider:i,key:a,value:s}=t;if(e.rehydrateIn&&function(t){return t.type===d.e}(o)){const t=i.stateInstance;(null==t?void 0:t.ngxsDataAfterStorageEvent)&&(null===(r=null==t?void 0:t.ngxsDataAfterStorageEvent)||void 0===r||r.call(t,{key:a,value:s,data:n,provider:i}))}}static checkExpiredInit(t){const{info:e,rehydrateInfo:n,options:r,map:o}=t,{provider:i,engine:a}=r;n.rehydrateIn&&e.expiry&&E({provider:i,expiry:e.expiry,map:o,engine:a})}handle(t,e,n){if(this.skipStorageInterceptions)return n(t,e);const r=function(t){const e=Object(c.i)(t);return e(c.a)||e(c.h)}(e);return n(t=this.pullStateFromStorage(t,{action:e,init:r}),e).pipe(Object(f.a)(n=>this.pushStateToStorage(t,n,{action:e,init:r})))}serialize(e,n){const r={version:n.version,lastChanged:(new Date).toISOString(),data:_(e,n)};if(b(n)){const e=w(n,t.injector),o=new Date(Date.now()+parseInt(n.ttl));E({provider:n,expiry:o,map:this.ttlListeners,engine:e}),r.expiry=o.toISOString()}return JSON.stringify(r)}deserialize(t,e,n){return function(t,e,n){if(Object(l.w)(t)){if(function(t){return!("lastChanged"in t)||!t.lastChanged}(t))throw new N(e);if(function(t){const e=parseFloat(t.version);return isNaN(e)||e<1||parseInt(t.version)!==e}(t))throw new A(t.version);if(function(t){return!("data"in t)}(t))throw new O;return"base64"===n.decode?JSON.parse(atob(t.data)):t.data}throw new S(`"${e}" not an object`)}(t,e,n)}destroyOldTasks(){var e;null===(e=t.eventsSubscriptions)||void 0===e||e.unsubscribe(),t.ttlListeners=new WeakMap}pushStateToStorage(e,n,r){for(const[i]of this.entries){const a=Object(c.k)(e,i.path),s=Object(c.k)(n,i.path),u=i.fireInit&&r.init;if(a!==s||u){const e=w(i,t.injector),n=h(i);try{const t=this.serialize(s,i);e.setItem(n,t),this.keys.set(n)}catch(o){x(n,o.message)}}}}pullStateFromStorage(t,{action:e,init:n}){if(this.canBeSyncStoreWithStorage(e,n))for(const[r]of this.entries)t=this.deserializeByProvider(t,e,r);return t}canBeSyncStoreWithStorage(t,e){return this.size>0&&(e||t.type===d.e)}deserializeByProvider(e,n,r){const o=h(r),i=w(r,t.injector),a=i.getItem(o);return Object(l.u)(a)&&(e=this.deserializeHandler(e,{key:o,engine:i,provider:r,value:a,action:n})),e}deserializeHandler(e,n){const{key:r,provider:o,value:i}=n;try{const a=m(i),s=this.deserialize(a,i,o),u=function(t){const{data:e,provider:n}=t,r=Object(l.u)(e)||n.nullable;let o={canBeOverrideFromStorage:r,versionMismatch:!1,expired:!1,expiry:null};return o=function(t,e,n){const{meta:r,provider:o}=n;if(t&&b(o)){const n=new Date(r.expiry);!isNaN(n.getTime())&&(e=g(n)?{canBeOverrideFromStorage:!1,expired:!0,expiry:n,versionMismatch:!1}:{canBeOverrideFromStorage:t,expired:!1,expiry:n,versionMismatch:!1})}return e}(r,o,t),o=function(t,e,n){const{meta:r,provider:o}=n;if(t&&r.version!==o.version){const t=o.stateInstance,n=!(o.skipMigrate||!(null==t?void 0:t.ngxsDataStorageMigrate)&&!o.migrate);e=Object.assign(Object.assign({},e),n?{versionMismatch:!0}:{canBeOverrideFromStorage:!1,versionMismatch:!0})}return e}(r,o,t),o}({provider:o,meta:a,data:s});if(u.canBeOverrideFromStorage){const i=function(t){var e;let n=t.states;const{provider:r,data:o,info:i}=t;if(!r.rehydrate)return{states:n,rehydrateIn:!1};const a=Object(c.k)(n,r.path);if(i.versionMismatch){const t=r.stateInstance,i=r.migrate||(null===(e=t.ngxsDataStorageMigrate)||void 0===e?void 0:e.bind(r.stateInstance)),s=null==i?void 0:i(a,o);return n=Object(c.l)(n,r.path,s),{states:n,rehydrateIn:!0}}return JSON.stringify(a)!==JSON.stringify(o)?(n=Object(c.l)(n,r.path,o),{states:n,rehydrateIn:!0}):{states:n,rehydrateIn:!1}}({states:e,provider:o,data:s,info:u});this.keys.set(r),e=i.states,t.checkIsStorageEvent(n,i,s),t.checkExpiredInit({info:u,rehydrateInfo:i,options:n,map:this.ttlListeners})}else this.removeKeyWhenPullInvalid(u,n)}catch(a){!function(t,e,n){console.warn(`${d.c.NGXS_PERSISTENCE_DESERIALIZE} from metadata { key: '${t}', value: '${e}' }. \nError deserialize: ${n}`)}(r,i,a.message)}return e}removeKeyWhenPullInvalid(t,e){const{key:n,engine:r,provider:o}=e;t.expired&&y(n,{provider:o,engine:r,map:this.ttlListeners,expiry:t.expiry}),r.removeItem(n),this.keys.delete(n)}listenWindowEvents(){Object(u.r)(this._platformId)||(this.destroyOldTasks(),t.eventsSubscriptions=Object(p.a)(window,"storage").subscribe(t=>{t.key&&this.keys.has(t.key)&&this.store.dispatch({type:d.e})}))}}return t.injector=null,t.eventsSubscriptions=null,t.ttlListeners=new WeakMap,t.\u0275fac=function(e){return new(e||t)(r.Zb(r.D),r.Zb(r.t,2))},t.\u0275prov=r.Lb({token:t,factory:t.\u0275fac}),t})();const M={provide:c.b,useClass:D,multi:!0},j=new r.s("NGXS_DATA_STORAGE_PREFIX_TOKEN");function k(t){var e;try{const n=null===(e=D.injector)||void 0===e?void 0:e.get(o);t.forEach(t=>{n.providers.add(t)})}catch(n){throw new Error(d.c.NGXS_PERSISTENCE_CONTAINER)}}function C(t,e,n){var r,o;let i;const a=null===(r=D.injector)||void 0===r?void 0:r.get(j,"@ngxs.store."),c=null===(o=D.injector)||void 0===o?void 0:o.get(s,"none");return i=n?(Array.isArray(n)?n:[n]).map(n=>function({option:t,decodeType:e,prefix:n,meta:r,stateInstance:o}){return function(t,e){return"path"in e||(e=Object.assign(Object.assign({},e),{get path(){return t.stateMeta&&t.stateMeta.path}})),e}(r,Object.assign(Object.assign({},t),{ttl:Object(l.u)(t.ttl)?t.ttl:-1,version:Object(l.u)(t.version)?t.version:1,decode:Object(l.u)(t.decode)?t.decode:e,prefixKey:Object(l.u)(t.prefixKey)?t.prefixKey:n,nullable:!!Object(l.u)(t.nullable)&&t.nullable,fireInit:!Object(l.u)(t.fireInit)||t.fireInit,rehydrate:!Object(l.u)(t.rehydrate)||t.rehydrate,ttlDelay:Object(l.u)(t.ttlDelay)?t.ttlDelay:6e4,ttlExpiredStrategy:Object(l.u)(t.ttlExpiredStrategy)?t.ttlExpiredStrategy:0,stateInstance:Object(l.u)(t.stateInstance)?t.stateInstance:o,skipMigrate:!!Object(l.u)(t.skipMigrate)&&t.skipMigrate}))}({option:n,prefix:a,decodeType:c,meta:t,stateInstance:e})):function(t){const{meta:e,decodeType:n,prefix:r,stateInstance:o}=t;return[{get path(){return e.stateMeta&&e.stateMeta.path},existingEngine:localStorage,ttl:-1,version:1,decode:n,prefixKey:r,nullable:!1,fireInit:!0,rehydrate:!0,ttlDelay:6e4,ttlExpiredStrategy:0,stateInstance:o,skipMigrate:!1}]}({meta:t,prefix:a,decodeType:c,stateInstance:e}),i}},UFJs:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"f",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c}));const r="NGXS_DATA_STORAGE_EVENT_TYPE",o="NGXS_DATA_META";var i=function(t){return t.NGXS_PERSISTENCE_STATE="@Persistence should be add before decorator @State and @StateRepository",t.NGXS_DATA_STATE="@StateRepository should be add before decorator @State",t.NGXS_DATA_STATE_NAME_NOT_FOUND="State name not provided in class",t.NGXS_DATA_MODULE_EXCEPTION="Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!",t.NGXS_DATA_STATE_DECORATOR="You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])",t.NGXS_DATA_STATIC_ACTION="Cannot support static methods with @DataAction()",t.NGXS_DATA_ACTION="@DataAction() can only decorate a method implementation",t.NGXS_DATA_ASYNC_ACTION_RETURN_TYPE="WARNING: If you use asynchronous actions `@Debounce() @DataAction()` the return result type should only void instead:",t.NGXS_PERSISTENCE_CONTAINER="You forgot provide NGXS_DATA_STORAGE_CONTAINER or NGXS_DATA_STORAGE_EXTENSION!!! Example: \n\n@NgModule({\n imports: [ \n   NgxsDataPluginModule.forRoot([NGXS_DATA_STORAGE_PLUGIN]) \n ]\n})\nexport class AppModule {} \n\n",t.NGXS_PERSISTENCE_ENGINE="Not found storage engine from `existingEngine` or not found instance after injecting by `useClass`.",t.NGXS_PERSISTENCE_SERIALIZE="Error occurred while serializing value",t.NGXS_PERSISTENCE_DESERIALIZE="Error occurred while deserializing value",t.NGXS_DATA_CHILDREN_CONVERT="Child states can only be added to an object",t.NGXS_INVALID_PAYLOAD_NAME="Payload name should be initialized",t.NGXS_INVALID_ARG_NAME="Argument name should be initialized",t.NGXS_COMPUTED_DECORATOR="The method must be a getter for the computed decorator to work properly.",t.NGXS_COMPARE="You must set the compare function before sorting.",t}({});const a="NGXS_META",s="NGXS_ARGUMENT_REGISTRY_META",c="NGXS_COMPUTED_OPTION"},i2FL:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(t){return t.ID="id",t}({})},"ty+z":function(t,e,n){"use strict";function r(t){return null!=t?t:{ids:[],entities:{}}}function o(t,e,n){return(null==e?void 0:e[t])>(null==n?void 0:n[t])?1:(null==e?void 0:e[t])<(null==n?void 0:n[t])?-1:0}function i(t,e,n){return(null==e?void 0:e[t])>(null==n?void 0:n[t])?-1:(null==e?void 0:e[t])<(null==n?void 0:n[t])?1:0}n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return c}));var a=n("fXoL"),s=n("ofXK");let c=(()=>{class t{}return t.\u0275mod=a.Nb({type:t}),t.\u0275inj=a.Mb({factory:function(e){return new(e||t)},imports:[[s.c]]}),t})()}},[[0,1,8]]]);